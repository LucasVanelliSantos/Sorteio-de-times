<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Divis√£o Equilibrada de Times</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #4CAF50;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .jogadores-input {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .jogador-item {
            display: flex;
            gap: 10px;
            align-items: center;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .jogador-item input[type="text"] {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .jogador-item input[type="number"] {
            width: 80px;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
        }

        .jogador-item input:focus {
            border-color: #4CAF50;
            outline: none;
        }

        .goleiro-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: #666;
        }

        .goleiro-checkbox input[type="checkbox"] {
            transform: scale(1.2);
        }

        .presenca-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: #666;
        }

        .presenca-checkbox input[type="checkbox"] {
            transform: scale(1.2);
        }

        .jogador-ausente {
            opacity: 0.5;
            background: #f8f9fa !important;
        }

        .jogador-ausente input {
            background: #e9ecef;
            color: #6c757d;
        }

        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #007bff, #0056b3);
        }

        .btn-warning {
            background: linear-gradient(45deg, #ffc107, #e0a800);
        }

        .controles {
            text-align: center;
            margin: 20px 0;
        }

        .times-resultado {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .time {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .time-a {
            border-top: 5px solid #FF6B6B;
        }

        .time-b {
            border-top: 5px solid #4ECDC4;
        }

        .time h3 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .time-a h3 {
            color: #FF6B6B;
        }

        .time-b h3 {
            color: #4ECDC4;
        }

        .jogador-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .jogador-card:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .jogador-nome {
            font-weight: bold;
            color: #333;
        }

        .jogador-nota {
            background: #4CAF50;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-weight: bold;
            min-width: 40px;
            text-align: center;
        }

        .goleiro-card {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            border: 2px solid #f1c40f;
            position: relative;
        }

        .goleiro-card::before {
            content: 'ü•Ö';
            position: absolute;
            left: -5px;
            top: -5px;
            font-size: 1.2em;
        }

        .goleiro-nota {
            background: #f39c12;
        }

        .estatisticas {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #eee;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
        }

        .equilibrio {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            border-radius: 10px;
        }

        .equilibrio-bom {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
        }

        .equilibrio-medio {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            color: #856404;
        }

        .equilibrio-ruim {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            color: #721c24;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .times-resultado {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .jogadores-input {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 2em;
            }

            .container {
                padding: 20px;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚öΩ Divis√£o Equilibrada de Times ‚öΩ</h1>

        <div class="section">
            <h2>üë• Cadastro dos 16 Jogadores</h2>
            <div class="jogadores-input" id="jogadoresInput">
                <!-- Jogadores ser√£o gerados dinamicamente -->
            </div>
            
            <div class="controles">
                <button class="btn btn-secondary" onclick="preencherExemplo()">
                    üìù Preencher Time
                </button>
                <button class="btn btn-warning" onclick="limparTodos()">
                    üóëÔ∏è Limpar Tudo
                </button>
                <button class="btn" onclick="dividirTimes()">
                    üé≤ Dividir Times
                </button>
            </div>
        </div>

        <div id="resultado" class="section hidden">
            <h2>üèÜ Times Formados</h2>
            
            <div class="equilibrio" id="equilibrioInfo">
                <!-- Info de equil√≠brio ser√° inserida aqui -->
            </div>

            <div class="times-resultado">
                <div class="time time-a">
                    <h3>üî¥ Time A</h3>
                    <div id="timeA"></div>
                    <div class="estatisticas">
                        <div class="stat">
                            <div class="stat-number" id="mediaA">0</div>
                            <div class="stat-label">M√©dia</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="totalA">0</div>
                            <div class="stat-label">Total</div>
                        </div>
                    </div>
                </div>

                <div class="time time-b">
                    <h3>üîµ Time B</h3>
                    <div id="timeB"></div>
                    <div class="estatisticas">
                        <div class="stat">
                            <div class="stat-number" id="mediaB">0</div>
                            <div class="stat-label">M√©dia</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="totalB">0</div>
                            <div class="stat-label">Total</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="controles">
                <button class="btn" onclick="dividirTimes()">
                    üîÑ Redistribuir Times
                </button>
            </div>
        </div>
    </div>

    <script>
        // Inicializar campos de entrada para 16 jogadores
        function inicializarCampos() {
            const container = document.getElementById('jogadoresInput');
            container.innerHTML = '';
            
            for (let i = 1; i <= 16; i++) {
                const jogadorItem = document.createElement('div');
                jogadorItem.className = 'jogador-item';
                jogadorItem.innerHTML = `
                    <input type="text" placeholder="Nome do Jogador ${i}" id="nome${i}">
                    <input type="number" min="0" max="10" step="0.1" placeholder="Nota" id="nota${i}">
                    <div class="goleiro-checkbox">
                        <input type="checkbox" id="goleiro${i}" onchange="limitarGoleiros()">
                        <label for="goleiro${i}">ü•Ö</label>
                    </div>
                    <div class="presenca-checkbox">
                        <input type="checkbox" id="presente${i}" checked onchange="atualizarEstadoJogador(${i})">
                        <label for="presente${i}">‚úÖ</label>
                    </div>
                `;
                container.appendChild(jogadorItem);
            }
        }

        // Atualizar estado visual do jogador baseado na presen√ßa
        function atualizarEstadoJogador(index) {
            const jogadorItem = document.querySelector(`#nome${index}`).parentElement;
            const presente = document.getElementById(`presente${index}`).checked;
            const goleiroCheckbox = document.getElementById(`goleiro${index}`);
            
            if (!presente) {
                jogadorItem.classList.add('jogador-ausente');
                // Desmarcar como goleiro se ausente
                goleiroCheckbox.checked = false;
                goleiroCheckbox.disabled = true;
            } else {
                jogadorItem.classList.remove('jogador-ausente');
                goleiroCheckbox.disabled = false;
            }
        }

        // Limitar sele√ß√£o a apenas 2 goleiros
        function limitarGoleiros() {
            const checkboxes = [];
            for (let i = 1; i <= 16; i++) {
                const goleiroCheckbox = document.getElementById(`goleiro${i}`);
                const presente = document.getElementById(`presente${i}`).checked;
                if (presente) { // S√≥ contar goleiros presentes
                    checkboxes.push(goleiroCheckbox);
                }
            }
            
            const selecionados = checkboxes.filter(cb => cb.checked);
            
            if (selecionados.length > 2) {
                // Desmarcar o √∫ltimo selecionado
                event.target.checked = false;
                alert('‚ö†Ô∏è M√°ximo de 2 goleiros permitidos!');
            }
        }

        // Preencher exemplo com dados fict√≠cios
        function preencherExemplo() {
            const nomes = [
                'Vanelli', 'Leandro', 'Rodrigo', 'Airton', 'Clinton', 'Cardozo', 'Patrick', 'Joaquim',
                'Denis', 'Rafel', 'Carlos', 'Cristiano', 'Micael', 'Convidado 14', 'Convidado 15', 'Convidado 16'
            ];
            
            const notas = [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10];
            
            // Simular que alguns jogadores n√£o vieram (√∫ltimos 2 por exemplo)
            const presentes = [true, true, true, true, true, true, true, true, 
                             true, true, true, true, true, false, false, false];
            
            for (let i = 1; i <= 16; i++) {
                document.getElementById(`nome${i}`).value = nomes[i-1];
                document.getElementById(`nota${i}`).value = notas[i-1];
                document.getElementById(`goleiro${i}`).checked = false;
                document.getElementById(`presente${i}`).checked = presentes[i-1];
                atualizarEstadoJogador(i);
            }
            
            // Definir os dois primeiros presentes como goleiros (Vanelli e Leandro)
            document.getElementById('goleiro1').checked = true;
            document.getElementById('goleiro2').checked = true;
        }

        // Limpar todos os campos
        function limparTodos() {
            for (let i = 1; i <= 16; i++) {
                document.getElementById(`nome${i}`).value = '';
                document.getElementById(`nota${i}`).value = '';
                document.getElementById(`goleiro${i}`).checked = false;
                document.getElementById(`presente${i}`).checked = true;
                atualizarEstadoJogador(i);
            }
            document.getElementById('resultado').classList.add('hidden');
        }

        // Coletar dados dos jogadores
        function coletarJogadores() {
            const jogadores = [];
            
            for (let i = 1; i <= 16; i++) {
                const nome = document.getElementById(`nome${i}`).value.trim();
                const nota = parseFloat(document.getElementById(`nota${i}`).value);
                const isGoleiro = document.getElementById(`goleiro${i}`).checked;
                const presente = document.getElementById(`presente${i}`).checked;
                
                if (nome && !isNaN(nota) && nota >= 0 && nota <= 10 && presente) {
                    jogadores.push({ nome, nota, isGoleiro, presente });
                }
            }
            
            return jogadores;
        }

        // Algoritmo para dividir times de forma equilibrada e rand√¥mica
        function dividirTimesEquilibrados(jogadores) {
            // Separar goleiros e jogadores de linha
            const goleiros = jogadores.filter(j => j.isGoleiro);
            const jogadoresLinha = jogadores.filter(j => !j.isGoleiro);
            
            // Gerar m√∫ltiplas combina√ß√µes aleat√≥rias e escolher a mais equilibrada
            let melhorDivisao = null;
            let menorDiferenca = Infinity;
            const tentativas = 100; // N√∫mero de tentativas para encontrar melhor divis√£o
            let tentativasUsadas = 0;
            
            for (let tentativa = 0; tentativa < tentativas; tentativa++) {
                tentativasUsadas++;
                const divisao = gerarDivisaoAleatoria(goleiros, jogadoresLinha);
                const mediaA = calcularMediaTime(divisao.timeA);
                const mediaB = calcularMediaTime(divisao.timeB);
                const diferenca = Math.abs(mediaA - mediaB);
                
                if (diferenca < menorDiferenca) {
                    menorDiferenca = diferenca;
                    melhorDivisao = { ...divisao, tentativasUsadas, diferenca: diferenca.toFixed(3) };
                }
                
                // Se encontrou divis√£o muito equilibrada, pode parar
                if (diferenca < 0.05) break;
            }
            
            return melhorDivisao;
        }
        
        // Gerar uma divis√£o completamente aleat√≥ria
        function gerarDivisaoAleatoria(goleiros, jogadoresLinha) {
            // Embaralhar jogadores de linha
            const jogadoresEmbaralhados = [...jogadoresLinha];
            embaralharArray(jogadoresEmbaralhados);
            
            let timeA = [];
            let timeB = [];
            
            // Distribuir goleiros
            if (goleiros.length === 2) {
                const goleirosCopia = [...goleiros];
                embaralharArray(goleirosCopia);
                timeA.push(goleirosCopia[0]);
                timeB.push(goleirosCopia[1]);
            } else if (goleiros.length === 1) {
                if (Math.random() < 0.5) {
                    timeA.push(goleiros[0]);
                } else {
                    timeB.push(goleiros[0]);
                }
            }
            
            // Distribuir jogadores de linha alternadamente (mas de forma embaralhada)
            for (let i = 0; i < jogadoresEmbaralhados.length; i++) {
                if (timeA.length <= timeB.length) {
                    timeA.push(jogadoresEmbaralhados[i]);
                } else {
                    timeB.push(jogadoresEmbaralhados[i]);
                }
            }
            
            // Embaralhar ordem dentro de cada time
            embaralharTimeMantenhoGoleiro(timeA);
            embaralharTimeMantenhoGoleiro(timeB);
            
            return { timeA, timeB };
        }
        
        // Embaralhar time mantendo goleiro na primeira posi√ß√£o
        function embaralharTimeMantenhoGoleiro(time) {
            const temGoleiro = time[0] && time[0].isGoleiro;
            if (temGoleiro) {
                const goleiro = time[0];
                const jogadoresLinha = time.slice(1);
                embaralharArray(jogadoresLinha);
                time.splice(0, time.length, goleiro, ...jogadoresLinha);
            } else {
                embaralharArray(time);
            }
        }
        
        // Calcular m√©dia de um time
        function calcularMediaTime(time) {
            if (time.length === 0) return 0;
            const soma = time.reduce((total, jogador) => total + jogador.nota, 0);
            return soma / time.length;
        }

        // Fun√ß√£o para embaralhar array
        function embaralharArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Calcular estat√≠sticas do time
        function calcularEstatisticas(time) {
            const total = time.reduce((sum, jogador) => sum + jogador.nota, 0);
            const media = total / time.length;
            return { total: total.toFixed(1), media: media.toFixed(1) };
        }

        // Exibir jogador no time
        function exibirJogador(jogador) {
            const cardClass = jogador.isGoleiro ? 'jogador-card goleiro-card' : 'jogador-card';
            const notaClass = jogador.isGoleiro ? 'jogador-nota goleiro-nota' : 'jogador-nota';
            const posicao = jogador.isGoleiro ? 'ü•Ö ' : '';
            
            return `
                <div class="${cardClass}">
                    <span class="jogador-nome">${posicao}${jogador.nome}</span>
                    <span class="${notaClass}">${jogador.nota}</span>
                </div>
            `;
        }

        // Avaliar equil√≠brio entre times
        function avaliarEquilibrio(mediaA, mediaB, tentativasUsadas = null) {
            const diferenca = Math.abs(mediaA - mediaB);
            let textoTentativas = tentativasUsadas ? ` (${tentativasUsadas} tentativas)` : '';
            
            if (diferenca <= 0.2) {
                return {
                    classe: 'equilibrio-bom',
                    texto: `‚úÖ Times muito equilibrados! Diferen√ßa: ${diferenca.toFixed(3)}${textoTentativas}`
                };
            } else if (diferenca <= 0.4) {
                return {
                    classe: 'equilibrio-medio',
                    texto: `‚ö†Ô∏è Times razoavelmente equilibrados. Diferen√ßa: ${diferenca.toFixed(3)}${textoTentativas}`
                };
            } else {
                return {
                    classe: 'equilibrio-ruim',
                    texto: `‚ùå Times desiquilibrados. Diferen√ßa: ${diferenca.toFixed(3)}${textoTentativas}`
                };
            }
        }

        // Fun√ß√£o principal para dividir times
        function dividirTimes() {
            const jogadores = coletarJogadores();
            
            if (jogadores.length < 4) {
                alert(`‚ùå Precisa de pelo menos 4 jogadores presentes para dividir os times!\nPresentes: ${jogadores.length}`);
                return;
            }
            
            if (jogadores.length % 2 !== 0) {
                alert(`‚ö†Ô∏è N√∫mero √≠mpar de jogadores presentes (${jogadores.length}). Um time ficar√° com um jogador a mais.`);
            }
            
            // Verificar se h√° exatamente 2 goleiros presentes
            const goleiros = jogadores.filter(j => j.isGoleiro);
            if (goleiros.length !== 2) {
                if (goleiros.length === 0) {
                    alert('‚ö†Ô∏è Nenhum goleiro selecionado! Continuando sem goleiros espec√≠ficos...');
                } else if (goleiros.length === 1) {
                    alert('‚ö†Ô∏è Apenas 1 goleiro presente! Um time ficar√° sem goleiro...');
                } else {
                    alert(`‚ùå Selecione exatamente 2 goleiros dentre os jogadores presentes!\nGoleiros presentes: ${goleiros.length}\n\nMarque 2 jogadores presentes com o √≠cone de goleiro ü•Ö`);
                    return;
                }
            }
            
            try {
                const { timeA, timeB } = dividirTimesEquilibrados(jogadores);
                
                // Calcular estat√≠sticas
                const statsA = calcularEstatisticas(timeA);
                const statsB = calcularEstatisticas(timeB);
                
                // Exibir times
                document.getElementById('timeA').innerHTML = timeA.map(exibirJogador).join('');
                document.getElementById('timeB').innerHTML = timeB.map(exibirJogador).join('');
                
                // Exibir estat√≠sticas
                document.getElementById('mediaA').textContent = statsA.media;
                document.getElementById('totalA').textContent = statsA.total;
                document.getElementById('mediaB').textContent = statsB.media;
                document.getElementById('totalB').textContent = statsB.total;
                
                // Avaliar equil√≠brio
                const equilibrio = avaliarEquilibrio(
                    parseFloat(statsA.media), 
                    parseFloat(statsB.media), 
                    timeA.tentativasUsadas
                );
                const equilibrioEl = document.getElementById('equilibrioInfo');
                equilibrioEl.className = `equilibrio ${equilibrio.classe}`;
                equilibrioEl.innerHTML = `
                    <div style="margin-bottom: 10px;">
                        <strong>üìä Jogadores Presentes: ${jogadores.length}/16</strong>
                    </div>
                    <div style="margin-bottom: 10px; font-size: 0.9em; color: #666;">
                        üé≤ Divis√£o Rand√¥mica Equilibrada - Melhor resultado em ${timeA.tentativasUsadas} tentativas
                    </div>
                    <strong>${equilibrio.texto}</strong>
                `;
                
                // Mostrar resultado
                document.getElementById('resultado').classList.remove('hidden');
                
                // Scroll para o resultado
                document.getElementById('resultado').scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
                
                console.log('‚öΩ Times divididos com sucesso!');
                console.log(`üìä Jogadores presentes: ${jogadores.length}`);
                console.log(`üé≤ Algoritmo rand√¥mico: ${timeA.tentativasUsadas} tentativas, diferen√ßa: ${timeA.diferenca}`);
                console.log('Time A:', timeA.map(j => `${j.nome} (${j.nota}${j.isGoleiro ? ' - Goleiro' : ''})`));
                console.log('Time B:', timeB.map(j => `${j.nome} (${j.nota}${j.isGoleiro ? ' - Goleiro' : ''})`));
                console.log(`Estat√≠sticas - Time A: ${statsA.media} | Time B: ${statsB.media}`);
                
            } catch (error) {
                alert(`‚ùå Erro: ${error.message}`);
            }
        }

        // Inicializar aplica√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            inicializarCampos();
            console.log('‚öΩ Aplicativo de Divis√£o de Times carregado!');
        });

        // Atalho de teclado - Enter para dividir times
        document.addEventListener('keypress', function(event) {
            if (event.key === 'Enter' && event.ctrlKey) {
                event.preventDefault();
                dividirTimes();
            }
        });
    </script>
</body>
</html>
